{
	"document": {
		"acknowledgments": [
			{
				"summary": "Cisco would like to thank Gerbert Roitburd from Secure Mobile Networking Lab (TU Darmstadt) for reporting this vulnerability."
			}
		],
		"category": "csaf_security_advisory",
		"csaf_version": "2.0",
		"notes": [
			{
				"category": "summary",
				"text": "A vulnerability in the interprocess communication (IPC) channel of Cisco AnyConnect Secure Mobility Client Software could allow an authenticated, local attacker to cause a targeted AnyConnect user to execute a malicious script.\r\n\r\nThe vulnerability is due to a lack of authentication to the IPC listener. An attacker could exploit this vulnerability by sending crafted IPC messages to the AnyConnect client IPC listener. A successful exploit could allow an attacker to cause the targeted AnyConnect user to execute a script. This script would execute with the privileges of the targeted AnyConnect user.\r\n\r\nNote: To successfully exploit this vulnerability, an attacker would need all of the following:\r\n\r\nValid user credentials on the system on which the AnyConnect client is being run by the targeted user.\r\nTo be able to log in to that system while the targeted user either has an active AnyConnect session established or establishes a new AnyConnect session.\r\nTo be able to execute code on that system.\r\n\r\nCisco has released software updates that address this vulnerability. There are workarounds that address this vulnerability.\r\n\r\n",
				"title": "Summary"
			},
			{
				"category": "general",
				"text": "This vulnerability affects all releases of Cisco AnyConnect Secure Mobility Client Software earlier than Release 4.10.00093 for the following platforms if they have a vulnerable configuration:\r\n\r\nAnyConnect Secure Mobility Client for Windows\r\nAnyConnect Secure Mobility Client for MacOS\r\nAnyConnect Secure Mobility Client for Linux\r\n\r\nThe following subsections describe how to determine vulnerability for specific releases of Cisco AnyConnect Secure Mobility Client Software. The release of Cisco AnyConnect Secure Mobility Client Software that is running on the end machine determines which configurations the user must check.\r\n\r\nThe configuration settings discussed in the following subsections are in the AnyConnectLocalPolicy.xml file. This file is in the following locations:\r\n\r\nWindows:<DriveLetter>:\\ProgramData\\Cisco\\Cisco AnyConnect Secure Mobility Client\\\r\nmacOS: /opt/cisco/anyconnect/\r\nLinux: /opt/cisco/anyconnect/\r\n  Cisco AnyConnect Secure Mobility Client Software Releases 4.9.04053, 4.9.05042, and 4.9.06037\r\nThe vulnerability described in this advisory affects Cisco AnyConnect Secure Mobility Client Software releases 4.9.04053, 4.9.05042, and 4.9.06037 if RestrictScriptWebDeploy is set to the default value of false.\r\n\r\nTo verify the RestrictScriptWebDeploy configuration setting on a VPN client system, open the AnyConnectLocalPolicy.xml file and look for the following line:\r\n\r\n\r\n<RestrictScriptWebDeploy>false</RestrictScriptWebDeploy>\r\n\r\nIf RestrictScriptWebDeploy is set to false, RestrictScriptWebDeploy is disabled and the device is affected by this vulnerability. If RestrictScriptWebDeploy is set to true, RestrictScriptWebDeploy is enabled and the device is not affected by this vulnerability.\r\n\r\nSee the Workarounds [\"#workarounds\"] section for additional optional but recommended settings.\r\n  Cisco AnyConnect Secure Mobility Client Software Releases Earlier than Release 4.9.04053\r\nThe vulnerability described in this advisory affects all releases of Cisco AnyConnect Secure Mobility Client Software earlier than Release 4.9.04053 if BypassDownloader is set to the default value of false.\r\n\r\nTo verify the BypassDownloader configuration setting on a VPN client system, open the AnyConnectLocalPolicy.xml file and look for the following line:\r\n\r\n\r\n<BypassDownloader>false</BypassDownloader>\r\n\r\nIf BypassDownloader is set to false, BypassDownloader is disabled and the device is affected by this vulnerability. If BypassDownloader is set to true, BypassDownloader is enabled and the device is not affected by this vulnerability.\r\n\r\nNote: Setting BypassDownloader to true is not a recommended configuration. See the Workarounds [\"#workarounds\"] section for more details.",
				"title": "Vulnerable Products"
			},
			{
				"category": "general",
				"text": "Only products listed in the Vulnerable Products [\"#vp\"] section of this advisory are known to be affected by this vulnerability.\r\n\r\nThis vulnerability does not affect Cisco AnyConnect Secure Mobility Client for Apple iOS or Android platforms or for the Universal Windows Platform.",
				"title": "Products Confirmed Not Vulnerable"
			},
			{
				"category": "general",
				"text": "Details about the vulnerability are as follows.\r\n\r\nThis vulnerability is not exploitable on laptops used by a single user, but instead requires valid logins for multiple users on the end-user device.\r\nThis vulnerability is not remotely exploitable, as it requires local credentials on the end-user device for the attacker to take action on the local system.\r\nThis vulnerability is not a privilege elevation exploit. The scripts run at the user level by default. If the local AnyConnect user manually raises the privilege of the User Interface process, the scripts would run at elevated privileges.\r\nThis vulnerability���s CVSS score is high because, for configurations where the vulnerability is exploitable, it allows one user access to another user���s data and execution space.",
				"title": "Details"
			},
			{
				"category": "general",
				"text": "Workarounds that address this vulnerability were introduced in Cisco bug ID CSCvw48062 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw48062\"] via new configuration settings. The new settings are available in releases 4.9.04053 and later. Cisco recommends using additional settings that were introduced in Release 4.10.00093 instead of using the settings introduced in 4.9.04053.\r\n\r\nThe settings introduced in 4.10.00093 allow connections to trusted headends only, without any functionality loss. Additional information about the new settings is in the Recommendations [\"#Recommendations\"] section of this advisory.\r\n  Cisco AnyConnect Secure Mobility Client Software Release 4.10.00093\r\nReleases 4.10.00093 and later contain the fix for Cisco bug ID CSCvv30103 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvv30103\"] with no additional configuration required. See the Recommendations [\"#Recommendations\"] section for additional optional but recommended settings.\r\n  Upgrade instructions for systems where workarounds were previously applied\r\nThis section is relevant only to customers that had previously applied the workaround settings for releases 4.9.04053, 4.9.05042, or 4.9.06037 or mitigation settings for releases earlier than Release 4.9.04053. If the workarounds or mitigations listed on this advisory were not previously used, use the normal upgrade process. More information about the normal upgrade process is in the Release Notes [\"https://www.cisco.com/c/en/us/td/docs/security/vpn_client/anyconnect/anyconnect410/release/notes/release-notes-anyconnect-4-10.html\"] or Configuration Guide [\"https://www.cisco.com/c/en/us/td/docs/security/vpn_client/anyconnect/anyconnect410/administration/guide/b-anyconnect-admin-guide-4-10/deploy-anyconnect.html?bookSearch=true\"].\r\n\r\nThe following instructions describe how to upgrade to Release 4.10.00093 and remove the previously applied settings in the AnyConnectLocalPolicy.xml file. This file is in the following locations:\r\n\r\nWindows:<DriveLetter>:\\ProgramData\\Cisco\\Cisco AnyConnect Secure Mobility Client\\\r\nmacOS: /opt/cisco/anyconnect/\r\nLinux: /opt/cisco/anyconnect/\r\n\r\n         AnyConnect Secure Mobility Client Software Release  AnyConnectLocalPolicy.xml Settings  Instructions\r\nEarlier than 4.9.04053\r\n\r\nPreviously deployed AnyConnectLocalPolicy.xml settings:\r\n\r\nBypassDownloader= true\r\n\r\nNew AnyConnectLocalPolicy.xml settings:\r\n\r\nBypassDownloader=false\r\n\r\n\r\nUpgrade to 4.10 using a predeploy method.\r\nRedistribute the AnyConnectLocalPolicy.xml file with new settings using an out-of-band deployment method.\r\nApply the new 4.10 settings shown in the Recommendations [\"#Recommendations\"] section.\r\n\r\n\r\n4.9.04053, 4.9.05042, 4.9.06037\r\n\r\nPreviously deployed AnyConnectLocalPolicy.xml settings:\r\n\r\nRestrictScriptWebDeploy=true\r\nRestrictHelpWebDeploy=true\r\nRestrictResourceWebDeploy=true\r\nRestrictLocalizationWebDeploy=true\r\nBypassDownloader=false\r\n\r\nNew AnyConnectLocalPolicy.xml settings:\r\n\r\nRestrictScriptWebDeploy=false\r\nRestrictHelpWebDeploy=false\r\nRestrictResourceWebDeploy=false\r\nRestrictLocalizationWebDeploy=false\r\nBypassDownloader=false\r\n\r\n\r\nUpgrade to 4.10 using either a predeploy or webdeploy method.\r\nRedistribute1 the AnyConnectLocalPolicy.xml file with new settings using an out-of-band deployment method.\r\nApply the new 4.10 settings shown in the Recommendations [\"#Recommendations\"] section.\r\n\r\n\r\n1. Customers may leave the settings intact for RestrictScriptWebDeploy, RestrictHelpWebDeploy, RestrictResourceWebDeploy, and RestrictLocalizationWebDeploy if the restricted functionality is not required. If these settings remain true, files must be distributed using an out-of-band deployment method.\r\n   Cisco AnyConnect Secure Mobility Client Software Releases 4.9.04053, 4.9.05042, and 4.9.06037  For customers who have already applied the RestrictScriptWebDeploy workaround\r\nFor customers using Release 4.9.04053, 4.9.05042, or 4.9.06037 who have already applied the RestrictScriptWebDeploy, RestrictHelpWebDeploy, RestrictResourceWebDeploy, RestrictLocalizationWebDeploy workarounds, nothing further needs to be done to help ensure protection against exploitation of this vulnerability.\r\n\r\nTo restore full functionality to the product, customers should upgrade to Release 4.10.00093 and apply the recommended settings shown in the Recommendations [\"#Recommendations\"] section. After full functionality is restored, customers can once again deploy files from the headend instead of using an out-of-band deployment method.\r\n  For customers who cannot upgrade to Release 4.10.00093 or later\r\nFor customers using Release 4.9.04053, 4.9.05042, or 4.9.06037 who cannot upgrade to Release 4.10.00093 or later, the recommended workaround for these releases is to edit the AnyConnectLocalPolicy.xml file to set RestrictScriptWebDeploy to true and ensure that BypassDownloader is set to false. The new AnyConnectLocalPolicy.xml file would then be deployed to end machines using an out-of-band method of deployment.\r\n\r\nThere are additional configuration settings for releases 4.9.04053, 4.9.05042, and 4.9.06037 that are strongly recommended for increased protection. The full set of custom web-deploy restrictions is listed below. For more details about the new configuration settings and implications of their use, refer to the Release Notes [\"https://www.cisco.com/c/en/us/td/docs/security/vpn_client/anyconnect/anyconnect49/release/notes/release-notes-anyconnect-4-9.html#Cisco_Reference.dita_79c2fd57-db64-4449-9072-26e62e46630b\"] or Cisco bug ID CSCvw48062 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw48062\"]. These settings would allow profile updates and future software upgrades while helping to protect against exploitation of this vulnerability.\r\n\r\nRestrictScriptWebDeploy\r\nRestrictHelpWebDeploy\r\nRestrictResourceWebDeploy\r\nRestrictLocalizationWebDeploy\r\n\r\nThe following procedure is for editing the policy on a local machine. In most deployment scenarios, the modification would be done to the AnyConnectLocalPolicy.xml file and then deployed to all client machines using an out-of-band method of deployment such as an enterprise software management system. Any modifications to the AnyConnectLocalPolicy.xml file must be done with sudo or admin rights.\r\n\r\nFind the AnyConnectLocalPolicy.xml file on the client machine. This file is in the following locations:\r\nWindows:<DriveLetter>:\\ProgramData\\Cisco\\Cisco AnyConnect Secure Mobility Client\\\r\nmacOS:/opt/cisco/anyconnect/\r\nLinux:/opt/cisco/anyconnect/\r\n\r\nOpen the AnyConnectLocalPolicy.xml file in a text editor and look for the following lines:\r\n<RestrictScriptWebDeploy>false</RestrictScriptWebDeploy>\r\n<RestrictHelpWebDeploy>false</RestrictHelpWebDeploy>  <RestrictResourceWebDeploy>false</RestrictResourceWebDeploy>  <RestrictLocalizationWebDeploy>false</RestrictLocalizationWebDeploy>\r\n\r\nChange that setting to true, as shown in the following example:\r\n<RestrictScriptWebDeploy>true</RestrictScriptWebDeploy>\r\n<RestrictHelpWebDeploy>true</RestrictHelpWebDeploy>  <RestrictResourceWebDeploy>true</RestrictResourceWebDeploy>  <RestrictLocalizationWebDeploy>true</RestrictLocalizationWebDeploy>\r\n\r\nVerify that the BypassDownloader setting is correct by looking for the following line:\r\n\r\n<BypassDownloader>false</BypassDownloader>\r\n\r\nIf the BypassDownloader setting is true, change it to false, as shown in the following example:\r\n\r\n<BypassDownloader>false</BypassDownloader>\r\n\r\nSave the file to the original location. The network paths are noted above.\r\nRestart the VPN Agent service or reboot the client machine.\r\n\r\n   Cisco AnyConnect Secure Mobility Client Software Earlier than Release 4.9.04053  For customers who have already applied the BypassDownloader mitigation\r\nFor customers using releases earlier than Release 4.9.04053 who have already applied the BypassDownloader mitigation, nothing further needs to be done to enable protection against exploitation of this vulnerability. Because this mitigation is not recommended, customers could upgrade to Release 4.10.00093 and apply the recommended settings shown in the Recommendations [\"#Recommendations\"] section.\r\n  For customers who cannot upgrade to Release 4.10.00093 or later\r\nFor customers using releases earlier than Release 4.9.04053 who cannot upgrade to Release 4.10.00093 or later and/or do not require updated content on the VPN headend device to be downloaded to the client, enabling the BypassDownloader setting is a possible mitigation.\r\n\r\nWarning: Changing the BypassDownloader setting is not recommended in most customer environments. If the BypassDownloader is set to true, VPN users could be refused a connection from the VPN headend if their local VPN XML profiles are out of date with what is configured on the VPN headend.\r\n\r\nNote: Enabling the BypassDownloader setting can be done only out-of-band on the client devices and has a couple of implications:\r\n\r\nAll future updates to either Cisco AnyConnect Secure Mobility Client Software or the AnyConnect profile would have to be done out-of-band. AnyConnect will no longer download updated content from the headend device.\r\nAnyConnect profiles would still need to be in sync between the headend device and the client. If the profiles are not in sync, the VPN connection could be established with default settings instead of with settings on the headend or client. The VPN headend could also refuse the connection.\r\n\r\nThe procedure that follows is for editing the policy on a local machine. In most deployment scenarios, the modification would be done to the AnyConnectLocalPolicy.xml file and then deployed to all client machines using an out-of-band method of deployment such as an enterprise software management system. Any modifications to the AnyConnectLocalPolicy.xml file must be done with sudo or admin rights.\r\n\r\nFind the AnyConnectLocalPolicy.xml file on the client machine. This file is in the following locations:\r\nWindows:<DriveLetter>:\\ProgramData\\Cisco\\Cisco AnyConnect Secure Mobility Client\\\r\nmacOS:/opt/cisco/anyconnect/\r\nLinux: /opt/cisco/anyconnect/\r\n\r\nOpen the AnyConnectLocalPolicy.xml file in a text editor and look for the following line:\r\n\r\n<BypassDownloader>false</BypassDownloader>\r\n\r\nChange that setting to true, as shown in the following example:\r\n\r\n<BypassDownloader>true</BypassDownloader>\r\n\r\nSave the file to the original location. The network paths are noted above.\r\nRestart the VPN Agent service or reboot the client machine.",
				"title": "Workarounds"
			},
			{
				"category": "general",
				"text": "Cisco has released free software updates that address the vulnerability described in this advisory. Customers may only install and expect support for software versions and feature sets for which they have purchased a license. By installing, downloading, accessing, or otherwise using such software upgrades, customers agree to follow the terms of the Cisco software license:\r\nhttps://www.cisco.com/c/en/us/products/end-user-license-agreement.html [\"https://www.cisco.com/c/en/us/products/end-user-license-agreement.html\"]\r\n\r\nAdditionally, customers may only download software for which they have a valid license, procured from Cisco directly, or through a Cisco authorized reseller or partner. In most cases this will be a maintenance upgrade to software that was previously purchased. Free security software updates do not entitle customers to a new software license, additional software feature sets, or major revision upgrades.\r\n\r\nWhen considering software upgrades [\"https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#fixes\"], customers are advised to regularly consult the advisories for Cisco products, which are available from the Cisco Security Advisories page [\"https://www.cisco.com/go/psirt\"], to determine exposure and a complete upgrade solution.\r\n\r\nIn all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.\r\n  Customers Without Service Contracts\r\nCustomers who purchase directly from Cisco but do not hold a Cisco service contract and customers who make purchases through third-party vendors but are unsuccessful in obtaining fixed software through their point of sale should obtain upgrades by contacting the Cisco TAC: https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html [\"https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html\"]\r\n\r\nCustomers should have the product serial number available and be prepared to provide the URL of this advisory as evidence of entitlement to a free upgrade.\r\n      Fixed Releases\r\nCisco fixed this vulnerability in Cisco AnyConnect Secure Mobility Client Software releases 4.10.00093 and later.",
				"title": "Fixed Software"
			},
			{
				"category": "general",
				"text": "Cisco AnyConnect Secure Mobility Client Software 4.10.00093 introduced new settings. It is now possible to individually allow/disallow scripts, help, resources, or localization updates in the local policy. These new settings are strongly recommended for increased protection. The full set of restrictions is listed below. For more details about the new configuration settings and implications of their use, refer to the AnyConnect Local Policy [\"https://www.cisco.com/c/en/us/td/docs/security/vpn_client/anyconnect/anyconnect410/administration/guide/b-anyconnect-admin-guide-4-10/anyconnect-profile-editor.html?bookSearch=true#ID-1430-000002bf%20%20\"] section of the administrator guide.\r\n        Configuration Setting Name  Default Value   Recommended Configuration Setting Value          StrictCertificateTrust   False  True      RestrictServerCertStore   False  True      AllowSoftwareUpdatesFromAnyServer   True  False      AllowComplianceUpdatesModuleFromAnyServer  True  False      AllowManagementVPNProfileUpdatesFromAnyServer  True  False      AllowISEPostureProfileUpdatesFromAnyServer  True  False      AllowServiceProfileUpdatesFromAnyServer  True  False      AllowScriptUpdatesFromAnyServer  True  False      AllowScriptUpdatesFromAnyServer  True  False      AllowHelpUpdatesFromAnyServer  True  False      AllowResourceUpdatesFromAnyServer  True  False      AllowLocalizationUpdatesFromAnyServer  True  False      ServerName  Blank  List of authorized servers.\r\nCan use wildcards, for example *.cisco.com\r\n\r\nBypassDownloader is not a new setting, but ensure that it is set to false.\r\n        Configuration Setting Name  Default Value   Recommended Configuration Setting Value          BypassDownloader  False  False\r\n\r\nTo configure the recommended settings on Release 4.10.00093 and later, edit the AnyConnectLocalPolicy.xml file to change configuration values to the recommended values listed in the preceding table. The new AnyConnectLocalPolicy.xml file would then be deployed to end machines.\r\n\r\nThe following procedure is for editing the policy on a local machine. In most deployment scenarios, the modification would be done to the AnyConnectLocalPolicy.xml file and then deployed to all client machines using an out-of-band method of deployment such as an enterprise software management system. Any modifications to the AnyConnectLocalPolicy.xml file must be done with sudo or admin rights.\r\n\r\nFind the AnyConnectLocalPolicy.xml file on the client machine. This file is in the following locations:\r\nWindows:<DriveLetter>:\\ProgramData\\Cisco\\Cisco AnyConnect Secure Mobility Client\\\r\nmacOS:/opt/cisco/anyconnect/\r\nLinux:/opt/cisco/anyconnect/\r\n\r\nOpen the AnyConnectLocalPolicy.xml file in a text editor and look for the following lines:\r\n\r\n<BypassDownloader>false</BypassDownloader>\r\n<StrictCertificateTrust>true</StrictCertificateTrust>\r\n<RestrictServerCertStore>true</RestrictServerCertStore>\r\n<AllowSoftwareUpdatesFromAnyServer>false</AllowSoftwareUpdatesFromAnyServer>\r\n<AllowComplianceUpdatesModuleFromAnyServer>false</AllowComplianceUpdatesModuleFromAnyServer>\r\n<AllowManagementVPNProfileUpdatesFromAnyServer>false</AllowManagementVPNProfileUpdatesFromAnyServer>\r\n<AllowISEPostureProfileUpdatesFromAnyServer>false</AllowISEPostureProfileUpdatesFromAnyServer>\r\n<AllowServiceProfileUpdatesFromAnyServer>false</AllowServiceProfileUpdatesFromAnyServer>\r\n<AllowScriptUpdatesFromAnyServer>false</AllowScriptUpdatesFromAnyServer>\r\n<AllowHelpUpdatesFromAnyServer>false</AllowHelpUpdatesFromAnyServer>\r\n<AllowResourceUpdatesFromAnyServer>false</AllowResourceUpdatesFromAnyServer>\r\n<AllowLocalizationUpdatesFromAnyServer>false</AllowLocalizationUpdatesFromAnyServer>\r\n\r\nIf the configuration setting values do not match the values shown above, change them.\r\nAdd authorized server names to the configuration file:\r\n<ServerName> *.example.com </ServerName>\r\n\r\nSave the file to the original location. The network paths are noted above.\r\nRestart the VPN Agent service or reboot the client machine.",
				"title": "Recommendations"
			},
			{
				"category": "general",
				"text": "To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy [\"https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html\"]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.",
				"title": "Vulnerability Policy"
			},
			{
				"category": "general",
				"text": "The Cisco Product Security Incident Response Team (PSIRT) is aware that proof-of-concept exploit code is available for the vulnerability described in this advisory.\r\n\r\nThe Cisco PSIRT is not aware of any malicious use of the vulnerability that is described in this advisory.",
				"title": "Exploitation and Public Announcements"
			},
			{
				"category": "general",
				"text": "Cisco would like to thank Gerbert Roitburd from Secure Mobile Networking Lab (TU Darmstadt) for reporting this vulnerability.",
				"title": "Source"
			},
			{
				"category": "legal_disclaimer",
				"text": "THIS DOCUMENT IS PROVIDED ON AN \"AS IS\" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.\r\n\r\nA standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.",
				"title": "Legal Disclaimer"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "psirt@cisco.com",
			"issuing_authority": "Cisco PSIRT",
			"name": "Cisco",
			"namespace": "https://wwww.cisco.com"
		},
		"references": [
			{
				"category": "self",
				"summary": "Cisco AnyConnect Secure Mobility Client Arbitrary Code Execution Vulnerability",
				"url": "https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-anyconnect-ipc-KfQO9QhK"
			},
			{
				"category": "external",
				"summary": "Cisco Security Vulnerability Policy",
				"url": "https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html"
			},
			{
				"category": "external",
				"summary": "CSCvw48062",
				"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw48062"
			},
			{
				"category": "external",
				"summary": "CSCvv30103",
				"url": "https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvv30103"
			},
			{
				"category": "external",
				"summary": "Release Notes",
				"url": "https://www.cisco.com/c/en/us/td/docs/security/vpn_client/anyconnect/anyconnect410/release/notes/release-notes-anyconnect-4-10.html"
			},
			{
				"category": "external",
				"summary": "Configuration Guide",
				"url": "https://www.cisco.com/c/en/us/td/docs/security/vpn_client/anyconnect/anyconnect410/administration/guide/b-anyconnect-admin-guide-4-10/deploy-anyconnect.html?bookSearch=true"
			},
			{
				"category": "external",
				"summary": "Release Notes",
				"url": "https://www.cisco.com/c/en/us/td/docs/security/vpn_client/anyconnect/anyconnect49/release/notes/release-notes-anyconnect-4-9.html#Cisco_Reference.dita_79c2fd57-db64-4449-9072-26e62e46630b"
			},
			{
				"category": "external",
				"summary": "https://www.cisco.com/c/en/us/products/end-user-license-agreement.html",
				"url": "https://www.cisco.com/c/en/us/products/end-user-license-agreement.html"
			},
			{
				"category": "external",
				"summary": "considering software upgrades",
				"url": "https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#fixes"
			},
			{
				"category": "external",
				"summary": "Cisco&nbsp;Security Advisories page",
				"url": "https://www.cisco.com/go/psirt"
			},
			{
				"category": "external",
				"summary": "https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html",
				"url": "https://www.cisco.com/c/en/us/support/web/tsd-cisco-worldwide-contacts.html"
			},
			{
				"category": "external",
				"summary": "AnyConnect Local Policy",
				"url": "https://www.cisco.com/c/en/us/td/docs/security/vpn_client/anyconnect/anyconnect410/administration/guide/b-anyconnect-admin-guide-4-10/anyconnect-profile-editor.html?bookSearch=true#ID-1430-000002bf%20%20"
			}
		],
		"title": "Cisco AnyConnect Secure Mobility Client Arbitrary Code Execution Vulnerability",
		"tracking": {
			"current_release_date": "2021-05-21T18:06:37+00:00",
			"generator": {
				"date": "2024-05-10T22:56:13+00:00",
				"engine": {
					"name": "TVCE"
				}
			},
			"id": "cisco-sa-anyconnect-ipc-KfQO9QhK",
			"initial_release_date": "2020-11-04T16:00:00+00:00",
			"revision_history": [
				{
					"date": "2020-11-04T15:21:41+00:00",
					"number": "1.0.0",
					"summary": "Initial public release."
				},
				{
					"date": "2020-11-05T22:27:26+00:00",
					"number": "2.0.0",
					"summary": "Clarified the requirements for a successful attack. Corrected information about vulnerable configurations and mitigations."
				},
				{
					"date": "2020-11-09T21:50:11+00:00",
					"number": "2.1.0",
					"summary": "Clarified mitigation information."
				},
				{
					"date": "2020-11-10T17:15:11+00:00",
					"number": "2.2.0",
					"summary": "Added additional details on the vulnerability. Clarified the mitigation."
				},
				{
					"date": "2020-12-04T15:21:28+00:00",
					"number": "3.0.0",
					"summary": "Added information about the enhancement CSCvw48062."
				},
				{
					"date": "2021-05-12T14:16:53+00:00",
					"number": "4.0.0",
					"summary": "Added fixed release information. Added Universal Windows Platform information."
				},
				{
					"date": "2021-05-21T18:06:37+00:00",
					"number": "4.1.0",
					"summary": "Updated the BypassDownloader tagging examples to include the closing \"/\" in three instances."
				}
			],
			"status": "final",
			"version": "4.1.0"
		}
	},
	"product_tree": {
		"branches": [
			{
				"branches": [
					{
						"category": "product_family",
						"name": "Cisco Secure Client",
						"product": {
							"name": "Cisco Secure Client ",
							"product_id": "CSAFPID-109810"
						}
					}
				],
				"category": "vendor",
				"name": "Cisco"
			}
		]
	},
	"vulnerabilities": [
		{
			"cve": "CVE-2020-3556",
			"ids": [
				{
					"system_name": "Cisco Bug ID",
					"text": "CSCvv30103"
				}
			],
			"notes": [
				{
					"category": "other",
					"text": "Complete.",
					"title": "Affected Product Comprehensiveness"
				}
			],
			"product_status": {
				"known_affected": [
					"CSAFPID-109810"
				]
			},
			"release_date": "2020-11-04T16:00:00+00:00",
			"remediations": [
				{
					"category": "vendor_fix",
					"details": "Cisco has released software updates that address this vulnerability.",
					"product_ids": [
						"CSAFPID-109810"
					],
					"url": "https://software.cisco.com"
				},
				{
					"category": "workaround",
					"details": "Workarounds that address this vulnerability were introduced in Cisco bug ID CSCvw48062 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw48062\"] via new configuration settings. The new settings are available in releases 4.9.04053 and later. Cisco recommends using additional settings that were introduced in Release 4.10.00093 instead of using the settings introduced in 4.9.04053.\r\n\r\nThe settings introduced in 4.10.00093 allow connections to trusted headends only, without any functionality loss. Additional information about the new settings is in the Recommendations [\"#Recommendations\"] section of this advisory.\r\n  Cisco AnyConnect Secure Mobility Client Software Release 4.10.00093\r\nReleases 4.10.00093 and later contain the fix for Cisco bug ID CSCvv30103 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvv30103\"] with no additional configuration required. See the Recommendations [\"#Recommendations\"] section for additional optional but recommended settings.\r\n  Upgrade instructions for systems where workarounds were previously applied\r\nThis section is relevant only to customers that had previously applied the workaround settings for releases 4.9.04053, 4.9.05042, or 4.9.06037 or mitigation settings for releases earlier than Release 4.9.04053. If the workarounds or mitigations listed on this advisory were not previously used, use the normal upgrade process. More information about the normal upgrade process is in the Release Notes [\"https://www.cisco.com/c/en/us/td/docs/security/vpn_client/anyconnect/anyconnect410/release/notes/release-notes-anyconnect-4-10.html\"] or Configuration Guide [\"https://www.cisco.com/c/en/us/td/docs/security/vpn_client/anyconnect/anyconnect410/administration/guide/b-anyconnect-admin-guide-4-10/deploy-anyconnect.html?bookSearch=true\"].\r\n\r\nThe following instructions describe how to upgrade to Release 4.10.00093 and remove the previously applied settings in the AnyConnectLocalPolicy.xml file. This file is in the following locations:\r\n\r\nWindows:<DriveLetter>:\\ProgramData\\Cisco\\Cisco AnyConnect Secure Mobility Client\\\r\nmacOS: /opt/cisco/anyconnect/\r\nLinux: /opt/cisco/anyconnect/\r\n\r\n         AnyConnect Secure Mobility Client Software Release  AnyConnectLocalPolicy.xml Settings  Instructions\r\nEarlier than 4.9.04053\r\n\r\nPreviously deployed AnyConnectLocalPolicy.xml settings:\r\n\r\nBypassDownloader= true\r\n\r\nNew AnyConnectLocalPolicy.xml settings:\r\n\r\nBypassDownloader=false\r\n\r\n\r\nUpgrade to 4.10 using a predeploy method.\r\nRedistribute the AnyConnectLocalPolicy.xml file with new settings using an out-of-band deployment method.\r\nApply the new 4.10 settings shown in the Recommendations [\"#Recommendations\"] section.\r\n\r\n\r\n4.9.04053, 4.9.05042, 4.9.06037\r\n\r\nPreviously deployed AnyConnectLocalPolicy.xml settings:\r\n\r\nRestrictScriptWebDeploy=true\r\nRestrictHelpWebDeploy=true\r\nRestrictResourceWebDeploy=true\r\nRestrictLocalizationWebDeploy=true\r\nBypassDownloader=false\r\n\r\nNew AnyConnectLocalPolicy.xml settings:\r\n\r\nRestrictScriptWebDeploy=false\r\nRestrictHelpWebDeploy=false\r\nRestrictResourceWebDeploy=false\r\nRestrictLocalizationWebDeploy=false\r\nBypassDownloader=false\r\n\r\n\r\nUpgrade to 4.10 using either a predeploy or webdeploy method.\r\nRedistribute1 the AnyConnectLocalPolicy.xml file with new settings using an out-of-band deployment method.\r\nApply the new 4.10 settings shown in the Recommendations [\"#Recommendations\"] section.\r\n\r\n\r\n1. Customers may leave the settings intact for RestrictScriptWebDeploy, RestrictHelpWebDeploy, RestrictResourceWebDeploy, and RestrictLocalizationWebDeploy if the restricted functionality is not required. If these settings remain true, files must be distributed using an out-of-band deployment method.\r\n   Cisco AnyConnect Secure Mobility Client Software Releases 4.9.04053, 4.9.05042, and 4.9.06037  For customers who have already applied the RestrictScriptWebDeploy workaround\r\nFor customers using Release 4.9.04053, 4.9.05042, or 4.9.06037 who have already applied the RestrictScriptWebDeploy, RestrictHelpWebDeploy, RestrictResourceWebDeploy, RestrictLocalizationWebDeploy workarounds, nothing further needs to be done to help ensure protection against exploitation of this vulnerability.\r\n\r\nTo restore full functionality to the product, customers should upgrade to Release 4.10.00093 and apply the recommended settings shown in the Recommendations [\"#Recommendations\"] section. After full functionality is restored, customers can once again deploy files from the headend instead of using an out-of-band deployment method.\r\n  For customers who cannot upgrade to Release 4.10.00093 or later\r\nFor customers using Release 4.9.04053, 4.9.05042, or 4.9.06037 who cannot upgrade to Release 4.10.00093 or later, the recommended workaround for these releases is to edit the AnyConnectLocalPolicy.xml file to set RestrictScriptWebDeploy to true and ensure that BypassDownloader is set to false. The new AnyConnectLocalPolicy.xml file would then be deployed to end machines using an out-of-band method of deployment.\r\n\r\nThere are additional configuration settings for releases 4.9.04053, 4.9.05042, and 4.9.06037 that are strongly recommended for increased protection. The full set of custom web-deploy restrictions is listed below. For more details about the new configuration settings and implications of their use, refer to the Release Notes [\"https://www.cisco.com/c/en/us/td/docs/security/vpn_client/anyconnect/anyconnect49/release/notes/release-notes-anyconnect-4-9.html#Cisco_Reference.dita_79c2fd57-db64-4449-9072-26e62e46630b\"] or Cisco bug ID CSCvw48062 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCvw48062\"]. These settings would allow profile updates and future software upgrades while helping to protect against exploitation of this vulnerability.\r\n\r\nRestrictScriptWebDeploy\r\nRestrictHelpWebDeploy\r\nRestrictResourceWebDeploy\r\nRestrictLocalizationWebDeploy\r\n\r\nThe following procedure is for editing the policy on a local machine. In most deployment scenarios, the modification would be done to the AnyConnectLocalPolicy.xml file and then deployed to all client machines using an out-of-band method of deployment such as an enterprise software management system. Any modifications to the AnyConnectLocalPolicy.xml file must be done with sudo or admin rights.\r\n\r\nFind the AnyConnectLocalPolicy.xml file on the client machine. This file is in the following locations:\r\nWindows:<DriveLetter>:\\ProgramData\\Cisco\\Cisco AnyConnect Secure Mobility Client\\\r\nmacOS:/opt/cisco/anyconnect/\r\nLinux:/opt/cisco/anyconnect/\r\n\r\nOpen the AnyConnectLocalPolicy.xml file in a text editor and look for the following lines:\r\n<RestrictScriptWebDeploy>false</RestrictScriptWebDeploy>\r\n<RestrictHelpWebDeploy>false</RestrictHelpWebDeploy>  <RestrictResourceWebDeploy>false</RestrictResourceWebDeploy>  <RestrictLocalizationWebDeploy>false</RestrictLocalizationWebDeploy>\r\n\r\nChange that setting to true, as shown in the following example:\r\n<RestrictScriptWebDeploy>true</RestrictScriptWebDeploy>\r\n<RestrictHelpWebDeploy>true</RestrictHelpWebDeploy>  <RestrictResourceWebDeploy>true</RestrictResourceWebDeploy>  <RestrictLocalizationWebDeploy>true</RestrictLocalizationWebDeploy>\r\n\r\nVerify that the BypassDownloader setting is correct by looking for the following line:\r\n\r\n<BypassDownloader>false</BypassDownloader>\r\n\r\nIf the BypassDownloader setting is true, change it to false, as shown in the following example:\r\n\r\n<BypassDownloader>false</BypassDownloader>\r\n\r\nSave the file to the original location. The network paths are noted above.\r\nRestart the VPN Agent service or reboot the client machine.\r\n\r\n   Cisco AnyConnect Secure Mobility Client Software Earlier than Release 4.9.04053  For customers who have already applied the BypassDownloader mitigation\r\nFor customers using releases earlier than Release 4.9.04053 who have already applied the BypassDownloader mitigation, nothing further needs to be done to enable protection against exploitation of this vulnerability. Because this mitigation is not recommended, customers could upgrade to Release 4.10.00093 and apply the recommended settings shown in the Recommendations [\"#Recommendations\"] section.\r\n  For customers who cannot upgrade to Release 4.10.00093 or later\r\nFor customers using releases earlier than Release 4.9.04053 who cannot upgrade to Release 4.10.00093 or later and/or do not require updated content on the VPN headend device to be downloaded to the client, enabling the BypassDownloader setting is a possible mitigation.\r\n\r\nWarning: Changing the BypassDownloader setting is not recommended in most customer environments. If the BypassDownloader is set to true, VPN users could be refused a connection from the VPN headend if their local VPN XML profiles are out of date with what is configured on the VPN headend.\r\n\r\nNote: Enabling the BypassDownloader setting can be done only out-of-band on the client devices and has a couple of implications:\r\n\r\nAll future updates to either Cisco AnyConnect Secure Mobility Client Software or the AnyConnect profile would have to be done out-of-band. AnyConnect will no longer download updated content from the headend device.\r\nAnyConnect profiles would still need to be in sync between the headend device and the client. If the profiles are not in sync, the VPN connection could be established with default settings instead of with settings on the headend or client. The VPN headend could also refuse the connection.\r\n\r\nThe procedure that follows is for editing the policy on a local machine. In most deployment scenarios, the modification would be done to the AnyConnectLocalPolicy.xml file and then deployed to all client machines using an out-of-band method of deployment such as an enterprise software management system. Any modifications to the AnyConnectLocalPolicy.xml file must be done with sudo or admin rights.\r\n\r\nFind the AnyConnectLocalPolicy.xml file on the client machine. This file is in the following locations:\r\nWindows:<DriveLetter>:\\ProgramData\\Cisco\\Cisco AnyConnect Secure Mobility Client\\\r\nmacOS:/opt/cisco/anyconnect/\r\nLinux: /opt/cisco/anyconnect/\r\n\r\nOpen the AnyConnectLocalPolicy.xml file in a text editor and look for the following line:\r\n\r\n<BypassDownloader>false</BypassDownloader>\r\n\r\nChange that setting to true, as shown in the following example:\r\n\r\n<BypassDownloader>true</BypassDownloader>\r\n\r\nSave the file to the original location. The network paths are noted above.\r\nRestart the VPN Agent service or reboot the client machine.",
					"product_ids": [
						"CSAFPID-109810"
					]
				}
			],
			"scores": [
				{
					"cvss_v3": {
						"baseScore": 7.3,
						"baseSeverity": "HIGH",
						"vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
						"version": "3.1"
					},
					"products": [
						"CSAFPID-109810"
					]
				}
			],
			"title": "Cisco AnyConnect Secure Mobility Client  Arbitrary Script Execution Vulnerability"
		}
	]
}

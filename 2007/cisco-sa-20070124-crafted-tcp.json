{
	"document": {
		"category": "Cisco Security Advisory",
		"csaf_version": "2.0",
		"notes": [
			{
				"category": "summary",
				"text": "Cisco has released software updates that address these vulnerabilities. [Workarounds that mitigate these vulnerabilities are available.]      This advisory is posted at http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20070124-crafted-tcp [\"http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20070124-crafted-tcp\"].",
				"title": "Summary"
			},
			{
				"category": "general",
				"text": "This issue affects all Cisco devices running Cisco IOS software. To be  affected, devices must be configured to process Internet Protocol version 4  (IPv4) packets and receive TCP packets. Devices which run only Internet  Protocol version 6 (IPv6) are not affected.\r\n\r\n This vulnerability is present in all unfixed versions of Cisco IOS  software, including versions 9.x, 10.x, 11.x and 12.x.\r\n\r\nTo determine the software running on a Cisco product, log in to the  device and issue the \"show version\" command to  display the system banner. Cisco IOS software will identify itself as  \"Internetwork Operating System Software\" or simply \"IOS\". On the next line of  output, the image name will be displayed between parentheses, followed by  \"Version\" and the IOS release name. Other Cisco devices will not have the  \"show version\" command or will give different  output.\r\n\r\nThe following example identifies a Cisco product running Cisco IOS  release 12.2(14)S16 with an installed image name of C7200-IS-M:\r\n\r\n\r\nCisco Internetwork Operating System Software\r\nIOS (tm) 7200 Software (C7200-IS-M), Version 12.2(14)S16, RELEASE SOFTWARE (fc1)\r\n\r\nThe release train label is \"12.2\".\r\n\r\nThe next example shows a product running IOS release 12.3(7)T12 with an  image name of C7200-IK9S-M:\r\n\r\n\r\nCisco IOS Software, 7200 Software (C7200-IK9S-M), Version 12.3(7)T12, RELEASE SOFTWARE  (fc1)\r\n\r\n\r\nAdditional information about Cisco IOS Banners is available at:\r\n\r\n  http://www.cisco.com/web/about/security/intelligence/ios-ref.html [\"http://www.cisco.com/web/about/security/intelligence/ios-ref.html\"]",
				"title": "Vulnerable Products"
			},
			{
				"category": "general",
				"text": "Cisco products that do not run IOS are unaffected by this  vulnerability.\r\n\r\nCisco IOS-XR is not affected.\r\n\r\nNo other Cisco products are currently known to be affected by this  vulnerability.",
				"title": "Products Confirmed Not Vulnerable"
			},
			{
				"category": "general",
				"text": "TCP is the transport layer protocol designed to provide  connection-oriented, reliable delivery of a data stream. To accomplish this,  TCP uses a mixture of flags to indicate state and sequence numbers to identify  the order in which the packets are to be reassembled. TCP also provides a  number, called an acknowledgement number, that is used to indicate the sequence  number of the next packet expected. The full specification of the TCP protocol  can be found at http://www.ietf.org/rfc/rfc0793.txt [\"http://www.ietf.org/rfc/rfc0793.txt\"]  .\r\n\r\nCisco IOS devices that are configured to receive TCP packets are  exposed to this issue. This Advisory does not apply to traffic that is  transiting the device.\r\n\r\nCertain crafted packets destined to an IPv4 address assigned to a  physical or virtual interface on a Cisco IOS device may cause the device to  leak a small amount of memory. Over time, such a memory leak may lead to memory  exhaustion and potentially degraded service.\r\n\r\nAlthough this is an issue with TCP, it is not required to complete the  TCP 3-way handshake in order for the memory leak to be triggered. Therefore,  TCP packets with a spoofed source address may trigger the leak.\r\n\r\nThe following document contains additional information on how to  identify if your router is suffering from a memory leak in Processor memory:\r\n\r\n  http://www.cisco.com/en/US/products/sw/iosswrel/ps1831/products_tech_note09186a00800a6f3a.shtml#tshoot2 [\"http://www.cisco.com/en/US/products/sw/iosswrel/ps1831/products_tech_note09186a00800a6f3a.shtml#tshoot2\"]",
				"title": "Details"
			},
			{
				"category": "general",
				"text": "Additional mitigations that can be deployed on Cisco devices within the  network are available in the Cisco Applied Mitigation Bulletin companion  document for this advisory:\r\n\r\n  http://tools.cisco.com/security/center/content/CiscoAppliedMitigationBulletin/cisco-amb-20070124-crafted-tcp [\"http://tools.cisco.com/security/center/content/CiscoAppliedMitigationBulletin/cisco-amb-20070124-crafted-tcp\"]\r\n\r\n  Note: Configuring VTY access-class filters is not an effective mitigation  strategy for this vulnerability.\r\n  Infrastructure ACLs (iACL)\r\nAlthough it is often difficult to block traffic transiting your  network, it is possible to identify traffic which should never be allowed to  target your infrastructure devices and block that traffic at the border of your  network. Infrastructure ACLs are considered a network security best practice  and should be considered as a long-term addition to good network security as  well as a workaround for this specific vulnerability. The ACL example shown  below should be included as part of the deployed infrastructure access-list  which will protect all devices with IP addresses in the infrastructure IP  address range.\r\n\r\nA sample access list for devices running Cisco IOS is below:\r\n\r\n\r\n\r\n!--- Permit TCP services from trust hosts destined   !--- to infrastructure addresses.      access-list 150 permit tcp TRUSTED_HOSTS MASK INFRASTRUCTURE_ADDRESSES MASK      !--- Deny TCP packets from all other sources destined to infrastructure addresses.      access-list 150 deny   tcp any INFRASTRUCTURE_ADDRESSES MASK      !--- Permit all other traffic to transit the device.      access-list 150 permit IP any any    interface serial 2/0    ip access-group 150 in\r\n\r\nThe white paper entitled \"Protecting Your Core: Infrastructure  Protection Access Control Lists\" presents guidelines and recommended deployment  techniques for infrastructure protection access lists. This white paper can be  obtained here: http://www.cisco.com/warp/public/707/iacl.html [\"http://www.cisco.com/warp/public/707/iacl.html\"]\r\n  Receive ACLs (rACL)\r\nFor distributed platforms, Receive ACLs may be an option starting in  Cisco IOS Software Versions 12.0(21)S2 for the 12000 (GSR), 12.0(24)S for the  7500, and 12.0(31)S for the 10720. The Receive ACL protects the device from  harmful traffic before the traffic can impact the route processor. Receive ACLs  are designed to only protect the device on which it is configured. On the  12000, transit traffic is never affected by a receive ACL. Because of this, the  destination IP address \"any\" used in the example ACL entries below only refer  to the router's own physical or virtual IP addresses. On the 7500 and 10720,  transit traffic with IP options set will be subject to the Receive ACL and  permitted or denied accordingly. Receive ACLs are considered a network security  best practice, and should be considered as a long-term addition to good network  security, as well as a workaround for this specific vulnerability. The white  paper entitled \"GSR: Receive Access Control Lists\" will help you identify and  allow legitimate traffic to your device and deny all unwanted packets:  http://www.cisco.com/en/US/tech/tk648/tk361/technologies_white_paper09186a00801a0a5e.shtml [\"http://www.cisco.com/en/US/tech/tk648/tk361/technologies_white_paper09186a00801a0a5e.shtml\"]\r\n\r\nThe following is the receive path ACL written to permit this type of  traffic from trusted hosts:\r\n\r\n\r\n\r\n!--- Permit tcp services from trusted hosts allowed to the RP.                                                         access-list 151 permit tcp TRUSTED_ADDRESSES MASK any                                                              !--- Deny tcp services from all other sources to the RP.                                                               access-list 151 deny   tcp any any                                                                                 !--- Permit all other traffic to the RP.                                                                               access-list 151 permit ip any any                                                                                  !--- Apply this access list to the 'receive' path.                                                                     ip receive access-list 151\r\n    Control Plane Policing (CoPP)\r\nThe Control Plane Policing (CoPP) feature may be used to mitigate this  vulnerability. In the following example, only TCP traffic from trusted hosts  and with 'receive' destination IP addresses is permitted to reach the route  processor (RP). All other 'transit' IP traffic is unaffected.\r\n\r\nIt should be noted that dropping traffic from unknown or untrusted IP  addresses may affect hosts with dynamically assigned IP addresses from  connecting to the Cisco IOS device.\r\n\r\n\r\naccess-list 152 deny   tcp TRUSTED_ADDRESSES MASK any\r\naccess-list 152 permit tcp any any  access-list 152 deny  ip any any  !  class-map match-all permit-tcp-class   match access-group 152  !  !  policy-map permit-tcp-policy   class permit-tcp-class    drop  !  control-plane   service-policy input permit-tcp-policy\r\n\r\nIn the above CoPP example, the ACL entries that match the exploit  packets with the \"permit\" action result in these packets being discarded by the  policy-map \"drop\" function, while packets that match the \"deny\" action are not  affected by the policy-map drop function.\r\n\r\nPlease note that in the 12.2S and 12.0S Cisco IOS trains the policy-map  syntax is different:\r\n\r\n\r\npolicy-map permit-tcp-policy\r\n class class permit-tcp-class                                                                                police 32000 1500 1500 conform-action drop exceed-action drop\r\n\r\nCoPP is available in Cisco IOS release trains 12.0S, 12.2SX, 12.2S,  12.3T, 12.4, and 12.4T.\r\n\r\nAdditional information on the configuration and use of the CoPP feature  can be found at the following URL:\r\n\r\n  http://www.cisco.com/en/US/prod/collateral/iosswrel/ps6537/ps6586/ps6642/prod_white_paper0900aecd804fa16a.html [\"http://www.cisco.com/en/US/prod/collateral/iosswrel/ps6537/ps6586/ps6642/prod_white_paper0900aecd804fa16a.html\"]\r\n  Anti-spoofing\r\nThe Unicast Reverse Path Forwarding (Unicast RPF or uRPF) feature helps  to mitigate problems that are caused by spoofed IP source addresses. It is  available on Cisco routers and firewalls. For further details, please refer to:\r\n\r\n  http://www.cisco.com/en/US/docs/ios/11_1/feature/guide/uni_rpf.html [\"http://www.cisco.com/en/US/docs/ios/11_1/feature/guide/uni_rpf.html\"]\r\n\r\nBy enabling Unicast Reverse Path Forwarding (uRPF), all spoofed packets  will be dropped at the first device. To enable uRPF, use the following  commands.\r\n\r\n\r\nrouter(config)#ip cef\r\nrouter(config)#interface interface #                                                                        router(config-if)#ip verify unicast source reachable-via rx\r\n    BGP and BTSH/GTSM\r\nDepending on your release of software, it may be possible to protect  your BGP sessions from this memory leak. With the introduction of  CSCee73956 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCee73956\"]  (  registered [\"http://tools.cisco.com/RPF/register/register.do\"] customers only)  , Cisco IOS has improved support for BTSH  (BGP TTL Security Hack) to reduce, if not eliminate a risk of a memory leak due  to this vulnerability. This functionality is also known as GTSM (Generalized  TTL Security Mechanism) and documented in RFC 3682. This section refers to GTSM  as applied to eBGP sessions only.\r\n\r\nReleases of Cisco IOS that contain CSCee73956 are protected from this  attack against the BGP port (TCP port 179) only. Other ports should be  protected accordingly.\r\n\r\nBTSH is not supported for iBGP sessions. BTSH was first introduced in  Cisco IOS in 12.0(27)S, 12.3(7)T and 12.2(25)S. Note that the BTSH feature  prior to CSCee73956 will not protect against this vulnerability.\r\n\r\nFor more information on BTSH, please see:  http://www.cisco.com/en/US/docs/ios/12_3t/12_3t7/feature/guide/gt_btsh.html [\"http://www.cisco.com/en/US/docs/ios/12_3t/12_3t7/feature/guide/gt_btsh.html\"]\r\n  BGP and MD5\r\nConfiguring your Cisco IOS device for BGP MD5 authentication is a valid  workaround to help protect the vulnerable device from crafted TCP packets sent  against the BGP port (TCP 179).\r\n\r\nThis can be configured as shown in the following example:\r\n\r\n\r\nrouter(config)#router bgp <AS_number>\r\nrouter(config-router)#neighbor <IP_address> password <enter_your_secret_here>\r\n\r\nIt may be necessary to configure the same shared MD5 secret on both  peers and at the same time. The introduction of  CSCdx23494 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCdx23494\"]  (  registered [\"http://tools.cisco.com/RPF/register/register.do\"] customers only)  will allow dynamically changing BGP MD5  keys without tearing the BGP session down.\r\n\r\nAlthough the BGP session will not be reset, BGP updates will not be  processed until the same MD5 key is configured on both sides.\r\n\r\nPrior to the introduction of  CSCdx23494 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCdx23494\"]  (  registered [\"http://tools.cisco.com/RPF/register/register.do\"] customers only)  , failure to change the MD5 passwords at  the same time will break the existing BGP session, and the new session will not  get established until the exact same MD5 shared secret is configured on both  devices. For a detailed discussion on how to configure BGP, refer to the  following document:\r\n\r\n  http://www.cisco.com/en/US/docs/ios/12_0/np1/configuration/guide/1cbgp.html [\"http://www.cisco.com/en/US/docs/ios/12_0/np1/configuration/guide/1cbgp.html\"]\r\n\r\nOnce the MD5 shared secret is configured, it is prudent to change it  periodically. The exact period of time must fit within your company security  policy.",
				"title": "Workarounds"
			},
			{
				"category": "general",
				"text": "When considering software upgrades, also consult  http://www.cisco.com/go/psirt [\"http://www.cisco.com/go/psirt\"]  and any subsequent advisories to determine exposure and a complete upgrade  solution.\r\n\r\nIn all cases, customers should exercise caution to be certain the  devices to be upgraded contain sufficient memory and that current hardware and  software configurations will continue to be supported properly by the new  release. If the information is not clear, contact the Cisco Technical  Assistance Center (\"TAC\") or your contracted maintenance provider for  assistance.\r\n\r\nEach row of the Cisco IOS software table (below) describes a release  train and the platforms or products for which it is intended. If a given  release train is vulnerable, then the earliest possible releases that contain  the fix (the \"First Fixed Release\") and the anticipated date of availability  for each are listed in the \"Rebuild\" and \"Maintenance\" columns. A device  running a release in the given train that is earlier than the release in a  specific column (less than the First Fixed Release) is known to be vulnerable.  The release should be upgraded at least to the indicated release or a later  version (greater than or equal to the First Fixed Release label).\r\n\r\nFor more information on the terms \"Rebuild\" and \"Maintenance,\" consult  the following URL:\r\n\r\n  http://www.cisco.com/web/about/security/intelligence/ios-ref.html [\"http://www.cisco.com/web/about/security/intelligence/ios-ref.html\"].\r\n\r\n  Note: There are three IOS security advisories and one field notice being  published on January 24, 2007. Each advisory lists only the releases which fix  the issue described in the advisory. A combined software table is available at  http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20070124-bundle [\"http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20070124-bundle\"]  and can be used to choose a software release which fixes all security  vulnerabilities published as of January 24, 2007. Links for the advisories and  field notice are listed here.\r\n\r\n      http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20070124-IOS-IPv6 [\"http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20070124-IOS-IPv6\"]\r\n      http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20070124-crafted-tcp [\"http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20070124-crafted-tcp\"]\r\n      http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20070124-crafted-ip-option [\"http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20070124-crafted-ip-option\"]\r\n      http://www.cisco.com/en/US/ts/fn/620/fn62613.html [\"http://www.cisco.com/en/US/ts/fn/620/fn62613.html\"]\r\n\r\n Requests for software rebuilds to include the change for  Daylight Savings  Time (DST) [\"http://www.cisco.com/en/US/ts/fn/620/fn62613.html\"] that will be implemented in March 2007 should be directed  through the Technical Assistance Center (TAC), and this advisory should be used  as reference.\r\n\r\nMajor Release\r\n\r\nAvailability of Repaired Releases\r\n\r\n              Affected 12.0-Based Release\r\n\r\n              Rebuild\r\n\r\n              Maintenance\r\n\r\n12.0\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.0DA\r\n\r\nVulnerable; migrate to 12.2(10)DA5 or later\r\n\r\n12.0DB\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.0DC\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.0S\r\n\r\n12.0(31)S6\r\n\r\n12.0(32)S4\r\n\r\n12.0SC\r\n\r\nVulnerable; migrate to 12.3(13a)BC6 or later\r\n\r\n12.0SL\r\n\r\nVulnerable; migrate to 12.0(31)S6 or later\r\n\r\n12.0SP\r\n\r\nVulnerable; migrate to 12.0(31)S6 or later\r\n\r\n12.0ST\r\n\r\nVulnerable; migrate to 12.0(31)S6 or later\r\n\r\n12.0SX\r\n\r\n12.0(25)SX11\r\n\r\n12.0SY\r\n\r\n12.0(32)SY\r\n\r\n12.0SZ\r\n\r\nVulnerable; migrate to 12.0(31)S6 or later\r\n\r\n12.0T\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.0W\r\n\r\nNot vulnerable\r\n\r\n12.0WC\r\n\r\n12.0(5)WC15\r\n\r\n12.0WT\r\n\r\nNot vulnerable\r\n\r\n12.0XA\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.0XB\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.0XC\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.0XD\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.0XE\r\n\r\nVulnerable; migrate to 12.1(26)E7 or later\r\n\r\n12.0XF\r\n\r\nNot vulnerable\r\n\r\n12.0XG\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.0XH\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.0XI\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.0XJ\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.0XK\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.0XL\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.0XM\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.0XN\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.0XQ\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.0XR\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.0XS\r\n\r\nVulnerable; migrate to 12.1(26)E7 or later\r\n\r\n12.0XV\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.0XW\r\n\r\nNot vulnerable\r\n\r\n              Affected 12.1-Based Release\r\n\r\n              Rebuild\r\n\r\n              Maintenance\r\n\r\n12.1\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.1 AA\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.1 AX\r\n\r\nVulnerable; migrate to 12.2(25)EY4 or later\r\n\r\n12.1 AY\r\n\r\nVulnerable; migrate to 12.1(22)EA8 or later\r\n\r\n12.1 AZ\r\n\r\nVulnerable; migrate to 12.1(22)EA8 or later\r\n\r\n12.1 CX\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.1 DA\r\n\r\nVulnerable; migrate to 12.2(10)DA5 or later\r\n\r\n12.1 DB\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.1 DC\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.1E\r\n\r\n12.1(26)E7\r\n\r\n12.1(27b)E1\r\n\r\n12.1EA\r\n\r\n12.1(22)EA8\r\n\r\n12.1EB\r\n\r\nVulnerable; contact TAC\r\n\r\n12.1EC\r\n\r\nVulnerable; migrate to 12.3(13a)BC6 or later\r\n\r\n12.1EO\r\n\r\n12.1EO | 12.1(19)EO6; available 22-Feb-07\r\n\r\n12.1(20)EO3\r\n\r\n12.1EU\r\n\r\nVulnerable; migrate to 12.2(25)EWA6 or later\r\n\r\n12.1EV\r\n\r\nVulnerable; migrate to 12.2(27)SV4 or later\r\n\r\n12.1EW\r\n\r\nVulnerable; migrate to 12.2(25)EWA6 or later\r\n\r\n12.1EX\r\n\r\nVulnerable; migrate to 12.1(26)E7 or later\r\n\r\n12.1EY\r\n\r\nVulnerable; migrate to 12.1(26)E7 or later\r\n\r\n12.1EZ\r\n\r\nVulnerable; migrate to 12.1(26)E7 or later\r\n\r\n12.1T\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.1XA\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.1XB\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.1XC\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.1XD\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.1XE\r\n\r\nVulnerable; migrate to 12.1(26)E7 or later\r\n\r\n12.1XF\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1XG\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1XH\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.1XI\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.1XJ\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1XL\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1XM\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1XP\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1XQ\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1XR\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1XS\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.1XT\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1XU\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1XV\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1XW\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.1XX\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.1XY\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.1XZ\r\n\r\nVulnerable; migrate to 12.2(37) or later\r\n\r\n12.1YA\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1YB\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1YC\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1YD\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1YE\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1YF\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1YH\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1YI\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.1YJ\r\n\r\nVulnerable; migrate to 12.1(22)EA8 or later\r\n\r\n              Affected 12.2-Based Release\r\n\r\n              Rebuild\r\n\r\n              Maintenance\r\n\r\n12.2\r\n\r\n12.2(37)\r\n\r\n12.2B\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2BC\r\n\r\nVulnerable; migrate to 12.3(13a)BC6 or later\r\n\r\n12.2BW\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2BY\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2BZ\r\n\r\nVulnerable; migrate to 12.3(7)XI8 or later\r\n\r\n12.2CX\r\n\r\nVulnerable; migrate to 12.3(13a)BC6 or later\r\n\r\n12.2CY\r\n\r\nVulnerable; migrate to 12.3(13a)BC6 or later\r\n\r\n12.2CZ\r\n\r\nVulnerable; contact TAC\r\n\r\n12.2DA\r\n\r\n12.2(10)DA5\r\n\r\n12.2(12)DA10\r\n\r\n12.2DD\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2DX\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2EU\r\n\r\nVulnerable; migrate to 12.2(25)EWA6 or later\r\n\r\n12.2EW\r\n\r\nVulnerable; migrate to 12.2(25)EWA6 or later\r\n\r\n12.2EWA\r\n\r\n12.2(25)EWA6\r\n\r\n12.2EX\r\n\r\n12.2(25)EX1\r\n\r\n12.2EY\r\n\r\n12.2(25)EY4\r\n\r\n12.2EZ\r\n\r\nVulnerable; migrate to 12.2(25)SEE1 or later\r\n\r\n12.2FX\r\n\r\nVulnerable; migrate to 12.2(25)SEE1 or later\r\n\r\n12.2FY\r\n\r\nVulnerable; migrate to 12.2(25)SEE1 or later\r\n\r\n12.2FZ\r\n\r\nAll 12.2FZ releases are fixed\r\n\r\n12.2IXA\r\n\r\nVulnerable; migrate to 12.2(18)IXD; available              30-April-07\r\n\r\n12.2IXB\r\n\r\nVulnerable; migrate to 12.2(18)IXD; available              30-April-07\r\n\r\n12.2IXC\r\n\r\nVulnerable; migrate to 12.2(18)IXD; available              30-April-07\r\n\r\n12.2JA\r\n\r\nVulnerable; migrate to 12.3(8)JA2 or later\r\n\r\n12.2JK\r\n\r\nVulnerable; migrate to 12.4(4)T4 or later\r\n\r\n12.2MB\r\n\r\nVulnerable; migrate to 12.2(25)SW8 or later\r\n\r\n12.2MC\r\n\r\nVulnerable; migrate to 12.3(11)T11 or later\r\n\r\n12.2S\r\n\r\n12.2(25)S12; Available 12-Feb-07\r\n\r\n12.2SB\r\n\r\n12.2(28)SB2\r\n\r\n12.2(31)SB\r\n\r\n12.2SBC\r\n\r\n12.2(27)SBC5\r\n\r\n12.2SE\r\n\r\n12.2(35)SE\r\n\r\n12.2SEA\r\n\r\nVulnerable; migrate to 12.2(25)SEE1 or later\r\n\r\n12.2SEB\r\n\r\nVulnerable; migrate to 12.2(25)SEE1 or later\r\n\r\n12.2SEC\r\n\r\nVulnerable; migrate to 12.2(25)SEE1 or later\r\n\r\n12.2SED\r\n\r\nVulnerable; migrate to 12.2(25)SEE1 or later\r\n\r\n12.2SEE\r\n\r\n12.2(25)SEE1\r\n\r\n12.2SEF\r\n\r\n12.2(25)SEF1\r\n\r\n12.2SEG\r\n\r\nAll 12.2SEG releases are fixed\r\n\r\n12.2SG\r\n\r\n12.2(37)SG; Available 25-Apr-07\r\n\r\n12.2SGA\r\n\r\nAll 12.2SGA releases are fixed\r\n\r\n12.2SO\r\n\r\n12.2(18)SO7\r\n\r\n12.2SRA\r\n\r\nAll 12.2SRA releases are fixed\r\n\r\n12.2SRB\r\n\r\nAll 12.2SRB releases are fixed\r\n\r\n12.2SU\r\n\r\nVulnerable; migrate to 12.4(8) or later\r\n\r\n12.2SV\r\n\r\n12.2(27)SV4\r\n\r\n12.2(28)SV1\r\n\r\n12.2(29)SV1\r\n\r\n12.2SW\r\n\r\n12.2(25)SW8\r\n\r\n12.2SX\r\n\r\nVulnerable; migrate to 12.2(18)SXD7a or later\r\n\r\n12.2SXA\r\n\r\nVulnerable; migrate to 12.2(18)SXD7a or later\r\n\r\n12.2SXB\r\n\r\nVulnerable; migrate to 12.2(18)SXD7a or later\r\n\r\n12.2SXD\r\n\r\n12.2(18)SXD7a\r\n\r\n12.2SXE\r\n\r\n12.2(18)SXE6\r\n\r\n12.2SXF\r\n\r\n12.2(18)SXF5\r\n\r\n12.2SY\r\n\r\nVulnerable; migrate to 12.2(18)SXD7a or later\r\n\r\n12.2SZ\r\n\r\nVulnerable; migrate to 12.2(25)S12 or later; Available              12-Feb-07\r\n\r\n12.2T\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2TPC\r\n\r\nVulnerable; contact TAC\r\n\r\n12.2XA\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2XB\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2XC\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2XD\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2XE\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2XF\r\n\r\nVulnerable; migrate to 12.3(13a)BC6 or later\r\n\r\n12.2XG\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2XH\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2XI\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2XJ\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2XK\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2XL\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2XM\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2XN\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2XQ\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2XR\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2XS\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2XT\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2XU\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2XV\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2XW\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2YA\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2YB\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2YC\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2YD\r\n\r\nVulnerable; migrate to 12.3(11)T11 or later\r\n\r\n12.2YE\r\n\r\nVulnerable; migrate to 12.2(25)S12 or later; Available              12-Feb-07\r\n\r\n12.2YF\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2YG\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2YH\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2YJ\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2YK\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2YL\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2YM\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2YN\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2YO\r\n\r\nNot vulnerable\r\n\r\n12.2YP\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2YQ\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2YR\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2YS\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2YT\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2YU\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2YV\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2YW\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2YX\r\n\r\nVulnerable; migrate to 12.4(8) or later\r\n\r\n12.2YY\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2YZ\r\n\r\nVulnerable; migrate to 12.2(25)S12 or later; Available              12-Feb-07\r\n\r\n12.2ZA\r\n\r\nVulnerable; migrate to 12.2(18)SXD7a or later\r\n\r\n12.2ZB\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2ZC\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2ZD\r\n\r\nVulnerable; contact TAC\r\n\r\n12.2ZE\r\n\r\nVulnerable; migrate to 12.3(19) or later\r\n\r\n12.2ZF\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2ZG\r\n\r\nVulnerable; contact TAC\r\n\r\n12.2ZH\r\n\r\nVulnerable; contact TAC\r\n\r\n12.2ZJ\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2ZL\r\n\r\nVulnerable; contact TAC\r\n\r\n12.2ZN\r\n\r\nVulnerable; migrate to 12.3(4)T13 or later\r\n\r\n12.2ZP\r\n\r\nVulnerable; migrate to 12.4(8) or later\r\n\r\n              Affected 12.3-Based Release\r\n\r\n              Rebuild\r\n\r\n              Maintenance\r\n\r\n12.3\r\n\r\n12.3(10f)\r\n\r\n12.3(19)\r\n\r\n12.3B\r\n\r\nVulnerable; migrate to 12.3(11)T11 or later\r\n\r\n12.3BC\r\n\r\n12.3(13a)BC6\r\n\r\n12.3(17a)BC2\r\n\r\n12.3BW\r\n\r\nVulnerable; migrate to 13.3(11)T11 or later\r\n\r\n12.3JA\r\n\r\n12.3(8)JA2\r\n\r\n12.3JEA\r\n\r\nAll 12.3JEA releases are fixed\r\n\r\n12.3JEB\r\n\r\nAll 12.3JEB releases are fixed\r\n\r\n12.3JK\r\n\r\n12.3(2)JK2\r\n\r\n12.3JX\r\n\r\n12.3(7)JX4\r\n\r\n12.3(11)JX\r\n\r\n12.3T\r\n\r\n12.3(4)T13\r\n\r\n12.3(11)T11\r\n\r\nLimited platform support is available: Contact              TAC\r\n\r\nPlease migrate to 12.4(8) or later\r\n\r\n12.3TPC\r\n\r\nVulnerable; contact TAC\r\n\r\n12.3XA\r\n\r\nVulnerable; contact TAC\r\n\r\n12.3XB\r\n\r\nVulnerable; migrate to 12.3(11)T11 or later\r\n\r\n12.3XC\r\n\r\nVulnerable; contact TAC\r\n\r\n12.3XD\r\n\r\nVulnerable; migrate to 12.3(11)T11 or later\r\n\r\n12.3XE\r\n\r\nVulnerable; contact TAC\r\n\r\n12.3XF\r\n\r\nVulnerable; migrate to 12.3(11)T11 or later\r\n\r\n12.3XG\r\n\r\nVulnerable; contact TAC\r\n\r\n12.3XH\r\n\r\nVulnerable; migrate to 12.3(11)T11 or later\r\n\r\n12.3XI\r\n\r\n12.3(7)XI8\r\n\r\n12.3XJ\r\n\r\nVulnerable; migrate to 12.3(14)YX2 or later\r\n\r\n12.3XK\r\n\r\nVulnerable; migrate to 12.4(8) or later\r\n\r\n12.3XQ\r\n\r\nVulnerable; migrate to 12.4(8) or later\r\n\r\n12.3XR\r\n\r\nVulnerable; contact TAC\r\n\r\n12.3XS\r\n\r\nVulnerable; migrate to 12.4(8) or later\r\n\r\n12.3XU\r\n\r\nVulnerable; migrate to 12.4(2)T5 or later\r\n\r\n12.3XW\r\n\r\nVulnerable; migrate to 12.3(14)YX2 or later\r\n\r\n12.3XX\r\n\r\nVulnerable; migrate to 12.4(8) or later\r\n\r\n12.3XY\r\n\r\nVulnerable; migrate to 12.4(8) or later\r\n\r\n12.3YA\r\n\r\nVulnerable; contact TAC\r\n\r\n12.3YD\r\n\r\nVulnerable; migrate to 12.4(2)T5 or later\r\n\r\n12.3YF\r\n\r\nVulnerable; migrate to 12.3(14)YX2 or later\r\n\r\n12.3YG\r\n\r\nVulnerable; migrate to 12.4(2)T5 or later\r\n\r\n12.3YH\r\n\r\nVulnerable; migrate to 12.4(2)T5 or later\r\n\r\n12.3YI\r\n\r\nVulnerable; migrate to 12.4(2)T5 or later\r\n\r\n12.3YJ\r\n\r\nVulnerable; migrate to 12.3(14)YQ8 or later\r\n\r\n12.3YK\r\n\r\nVulnerable; migrate to 12.4(4)T4 or later\r\n\r\n12.3YM\r\n\r\n12.3(14)YM8\r\n\r\n12.3YQ\r\n\r\n12.3(14)YQ8\r\n\r\n12.3YS\r\n\r\nVulnerable; migrate to 12.4(4)T4 or later\r\n\r\n12.3YT\r\n\r\nVulnerable; migrate to 12.4(4)T4 or later\r\n\r\n12.3YU\r\n\r\nVulnerable; contact TAC\r\n\r\n12.3YX\r\n\r\n12.3(14)YX2\r\n\r\n12.3YZ\r\n\r\n12.3(11)YZ1\r\n\r\n              Affected 12.4-Based Release\r\n\r\n              Rebuild\r\n\r\n              Maintenance\r\n\r\n12.4\r\n\r\n12.4(3e)\r\n\r\n12.4(7b)\r\n\r\n12.4(8)\r\n\r\n12.4MR\r\n\r\n12.4(6)MR1\r\n\r\n12.4SW\r\n\r\nAll 12.4SW releases are fixed\r\n\r\n12.4T\r\n\r\n12.4(2)T5\r\n\r\n12.4(4)T4\r\n\r\n12.4(6)T3\r\n\r\n12.4(9)T\r\n\r\n12.4XA\r\n\r\nVulnerable; migrate to 12.4(6)T3\r\n\r\n12.4XB\r\n\r\nVulnerable; contact TAC\r\n\r\n12.4XC\r\n\r\n12.4(4)XC3\r\n\r\n12.4XD\r\n\r\n12.4(4)XD4\r\n\r\n12.4XE\r\n\r\nAll 12.4XE releases are fixed\r\n\r\n12.4XG\r\n\r\nAll 12.4XG releases are fixed\r\n\r\n 12.4XJ\r\n\r\n All 12.4XJ releases are fixed\r\n\r\n 12.4XP\r\n\r\n All 12.4XP releases are fixed\r\n\r\n 12.4XT\r\n\r\n All 12.4XT releases are fixed",
				"title": "Fixed Software"
			},
			{
				"category": "general",
				"text": "To learn about Cisco security vulnerability disclosure policies and publications, see the Security Vulnerability Policy [\"http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html\"]. This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.",
				"title": "Vulnerability Policy"
			},
			{
				"category": "general",
				"text": "The Cisco PSIRT is not aware of any public announcements or malicious  use of the vulnerability described in this advisory.\r\n\r\nThis vulnerability was discovered by Cisco during our internal testing  process.",
				"title": "Exploitation and Public Announcements"
			},
			{
				"category": "legal_disclaimer",
				"text": "THIS DOCUMENT IS PROVIDED ON AN \"AS IS\" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.\r\n\r\nA stand-alone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy, and may lack important information or contain factual errors. The information in this document is intended for end-users of Cisco products.",
				"title": "Legal Disclaimer"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "Emergency Support:\r\n+1 877 228 7302 (toll-free within North America)\r\n+1 408 525 6532 (International direct-dial)\r\nNon-emergency Support:\r\nEmail: psirt@cisco.com\r\nSupport requests that are received via e-mail are typically acknowledged within 48 hours.",
			"issuing_authority": "Cisco product security incident response is the responsibility of the Cisco Product Security Incident Response Team (PSIRT). The Cisco PSIRT is a dedicated, global team that manages the receipt, investigation, and public reporting of security vulnerability information that is related to Cisco products and networks. The on-call Cisco PSIRT works 24x7 with Cisco customers, independent security researchers, consultants, industry organizations, and other vendors to identify possible security issues with Cisco products and networks.\r\nMore information can be found in Cisco Security Vulnerability Policy available at http://www.cisco.com/web/about/security/psirt/security_vulnerability_policy.html",
			"name": "Cisco",
			"namespace": "https://wwww.cisco.com"
		},
		"references": [
			{
				"category": "self",
				"summary": "Crafted TCP Packet Can Cause Denial of Service",
				"url": "http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20070124-crafted-tcp"
			}
		],
		"title": "Crafted TCP Packet Can Cause Denial of Service",
		"tracking": {
			"current_release_date": "2007-01-24T00:00:00+00:00",
			"generator": {
				"date": "2022-07-15T00:05:18+00:00",
				"engine": {
					"name": "TVCE"
				}
			},
			"id": "cisco-sa-20070124-crafted-tcp",
			"initial_release_date": "2007-01-24T00:00:00+00:00",
			"revision_history": [
				{
					"date": "2007-01-24T00:00:00+00:00",
					"number": "1.1.0",
					"summary": "BGP and MD5 update."
				}
			],
			"status": "final",
			"version": "1.1.0"
		}
	},
	"product_tree": {},
	"vulnerabilities": [
		{
			"cve": "CVE-2007-0479",
			"notes": [
				{
					"category": "other",
					"text": "Complete.",
					"title": "Affected Product Comprehensiveness"
				}
			],
			"product_status": {},
			"references": [
				{
					"category": "self",
					"summary": "Crafted TCP Packet Can Cause Denial of Service",
					"url": "http://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20070124-crafted-tcp"
				}
			],
			"remediations": [
				{
					"category": "workaround",
					"details": "Additional mitigations that can be deployed on Cisco devices within the  network are available in the Cisco Applied Mitigation Bulletin companion  document for this advisory:\r\n\r\n  http://tools.cisco.com/security/center/content/CiscoAppliedMitigationBulletin/cisco-amb-20070124-crafted-tcp [\"http://tools.cisco.com/security/center/content/CiscoAppliedMitigationBulletin/cisco-amb-20070124-crafted-tcp\"]\r\n\r\n  Note: Configuring VTY access-class filters is not an effective mitigation  strategy for this vulnerability.\r\n  Infrastructure ACLs (iACL)\r\nAlthough it is often difficult to block traffic transiting your  network, it is possible to identify traffic which should never be allowed to  target your infrastructure devices and block that traffic at the border of your  network. Infrastructure ACLs are considered a network security best practice  and should be considered as a long-term addition to good network security as  well as a workaround for this specific vulnerability. The ACL example shown  below should be included as part of the deployed infrastructure access-list  which will protect all devices with IP addresses in the infrastructure IP  address range.\r\n\r\nA sample access list for devices running Cisco IOS is below:\r\n\r\n\r\n\r\n!--- Permit TCP services from trust hosts destined   !--- to infrastructure addresses.      access-list 150 permit tcp TRUSTED_HOSTS MASK INFRASTRUCTURE_ADDRESSES MASK      !--- Deny TCP packets from all other sources destined to infrastructure addresses.      access-list 150 deny   tcp any INFRASTRUCTURE_ADDRESSES MASK      !--- Permit all other traffic to transit the device.      access-list 150 permit IP any any    interface serial 2/0    ip access-group 150 in\r\n\r\nThe white paper entitled \"Protecting Your Core: Infrastructure  Protection Access Control Lists\" presents guidelines and recommended deployment  techniques for infrastructure protection access lists. This white paper can be  obtained here: http://www.cisco.com/warp/public/707/iacl.html [\"http://www.cisco.com/warp/public/707/iacl.html\"]\r\n  Receive ACLs (rACL)\r\nFor distributed platforms, Receive ACLs may be an option starting in  Cisco IOS Software Versions 12.0(21)S2 for the 12000 (GSR), 12.0(24)S for the  7500, and 12.0(31)S for the 10720. The Receive ACL protects the device from  harmful traffic before the traffic can impact the route processor. Receive ACLs  are designed to only protect the device on which it is configured. On the  12000, transit traffic is never affected by a receive ACL. Because of this, the  destination IP address \"any\" used in the example ACL entries below only refer  to the router's own physical or virtual IP addresses. On the 7500 and 10720,  transit traffic with IP options set will be subject to the Receive ACL and  permitted or denied accordingly. Receive ACLs are considered a network security  best practice, and should be considered as a long-term addition to good network  security, as well as a workaround for this specific vulnerability. The white  paper entitled \"GSR: Receive Access Control Lists\" will help you identify and  allow legitimate traffic to your device and deny all unwanted packets:  http://www.cisco.com/en/US/tech/tk648/tk361/technologies_white_paper09186a00801a0a5e.shtml [\"http://www.cisco.com/en/US/tech/tk648/tk361/technologies_white_paper09186a00801a0a5e.shtml\"]\r\n\r\nThe following is the receive path ACL written to permit this type of  traffic from trusted hosts:\r\n\r\n\r\n\r\n!--- Permit tcp services from trusted hosts allowed to the RP.                                                         access-list 151 permit tcp TRUSTED_ADDRESSES MASK any                                                              !--- Deny tcp services from all other sources to the RP.                                                               access-list 151 deny   tcp any any                                                                                 !--- Permit all other traffic to the RP.                                                                               access-list 151 permit ip any any                                                                                  !--- Apply this access list to the 'receive' path.                                                                     ip receive access-list 151\r\n    Control Plane Policing (CoPP)\r\nThe Control Plane Policing (CoPP) feature may be used to mitigate this  vulnerability. In the following example, only TCP traffic from trusted hosts  and with 'receive' destination IP addresses is permitted to reach the route  processor (RP). All other 'transit' IP traffic is unaffected.\r\n\r\nIt should be noted that dropping traffic from unknown or untrusted IP  addresses may affect hosts with dynamically assigned IP addresses from  connecting to the Cisco IOS device.\r\n\r\n\r\naccess-list 152 deny   tcp TRUSTED_ADDRESSES MASK any\r\naccess-list 152 permit tcp any any  access-list 152 deny  ip any any  !  class-map match-all permit-tcp-class   match access-group 152  !  !  policy-map permit-tcp-policy   class permit-tcp-class    drop  !  control-plane   service-policy input permit-tcp-policy\r\n\r\nIn the above CoPP example, the ACL entries that match the exploit  packets with the \"permit\" action result in these packets being discarded by the  policy-map \"drop\" function, while packets that match the \"deny\" action are not  affected by the policy-map drop function.\r\n\r\nPlease note that in the 12.2S and 12.0S Cisco IOS trains the policy-map  syntax is different:\r\n\r\n\r\npolicy-map permit-tcp-policy\r\n class class permit-tcp-class                                                                                police 32000 1500 1500 conform-action drop exceed-action drop\r\n\r\nCoPP is available in Cisco IOS release trains 12.0S, 12.2SX, 12.2S,  12.3T, 12.4, and 12.4T.\r\n\r\nAdditional information on the configuration and use of the CoPP feature  can be found at the following URL:\r\n\r\n  http://www.cisco.com/en/US/prod/collateral/iosswrel/ps6537/ps6586/ps6642/prod_white_paper0900aecd804fa16a.html [\"http://www.cisco.com/en/US/prod/collateral/iosswrel/ps6537/ps6586/ps6642/prod_white_paper0900aecd804fa16a.html\"]\r\n  Anti-spoofing\r\nThe Unicast Reverse Path Forwarding (Unicast RPF or uRPF) feature helps  to mitigate problems that are caused by spoofed IP source addresses. It is  available on Cisco routers and firewalls. For further details, please refer to:\r\n\r\n  http://www.cisco.com/en/US/docs/ios/11_1/feature/guide/uni_rpf.html [\"http://www.cisco.com/en/US/docs/ios/11_1/feature/guide/uni_rpf.html\"]\r\n\r\nBy enabling Unicast Reverse Path Forwarding (uRPF), all spoofed packets  will be dropped at the first device. To enable uRPF, use the following  commands.\r\n\r\n\r\nrouter(config)#ip cef\r\nrouter(config)#interface interface #                                                                        router(config-if)#ip verify unicast source reachable-via rx\r\n    BGP and BTSH/GTSM\r\nDepending on your release of software, it may be possible to protect  your BGP sessions from this memory leak. With the introduction of  CSCee73956 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCee73956\"]  (  registered [\"http://tools.cisco.com/RPF/register/register.do\"] customers only)  , Cisco IOS has improved support for BTSH  (BGP TTL Security Hack) to reduce, if not eliminate a risk of a memory leak due  to this vulnerability. This functionality is also known as GTSM (Generalized  TTL Security Mechanism) and documented in RFC 3682. This section refers to GTSM  as applied to eBGP sessions only.\r\n\r\nReleases of Cisco IOS that contain CSCee73956 are protected from this  attack against the BGP port (TCP port 179) only. Other ports should be  protected accordingly.\r\n\r\nBTSH is not supported for iBGP sessions. BTSH was first introduced in  Cisco IOS in 12.0(27)S, 12.3(7)T and 12.2(25)S. Note that the BTSH feature  prior to CSCee73956 will not protect against this vulnerability.\r\n\r\nFor more information on BTSH, please see:  http://www.cisco.com/en/US/docs/ios/12_3t/12_3t7/feature/guide/gt_btsh.html [\"http://www.cisco.com/en/US/docs/ios/12_3t/12_3t7/feature/guide/gt_btsh.html\"]\r\n  BGP and MD5\r\nConfiguring your Cisco IOS device for BGP MD5 authentication is a valid  workaround to help protect the vulnerable device from crafted TCP packets sent  against the BGP port (TCP 179).\r\n\r\nThis can be configured as shown in the following example:\r\n\r\n\r\nrouter(config)#router bgp <AS_number>\r\nrouter(config-router)#neighbor <IP_address> password <enter_your_secret_here>\r\n\r\nIt may be necessary to configure the same shared MD5 secret on both  peers and at the same time. The introduction of  CSCdx23494 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCdx23494\"]  (  registered [\"http://tools.cisco.com/RPF/register/register.do\"] customers only)  will allow dynamically changing BGP MD5  keys without tearing the BGP session down.\r\n\r\nAlthough the BGP session will not be reset, BGP updates will not be  processed until the same MD5 key is configured on both sides.\r\n\r\nPrior to the introduction of  CSCdx23494 [\"https://bst.cloudapps.cisco.com/bugsearch/bug/CSCdx23494\"]  (  registered [\"http://tools.cisco.com/RPF/register/register.do\"] customers only)  , failure to change the MD5 passwords at  the same time will break the existing BGP session, and the new session will not  get established until the exact same MD5 shared secret is configured on both  devices. For a detailed discussion on how to configure BGP, refer to the  following document:\r\n\r\n  http://www.cisco.com/en/US/docs/ios/12_0/np1/configuration/guide/1cbgp.html [\"http://www.cisco.com/en/US/docs/ios/12_0/np1/configuration/guide/1cbgp.html\"]\r\n\r\nOnce the MD5 shared secret is configured, it is prudent to change it  periodically. The exact period of time must fit within your company security  policy."
				}
			],
			"title": "Do not publish until the 24th or the PSIRT advisory goes live \n\nCisco IOS TCP Packet Denial of Service Vulnerability"
		}
	]
}
